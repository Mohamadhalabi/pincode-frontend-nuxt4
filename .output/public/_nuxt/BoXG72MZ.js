import{_ as T}from"./Dgi673JG.js";import{i as B,e as E,B as D,C as F,j as V,q as C,k as p,c as d,a as s,b as M,w as O,t as a,h as t,D as $,p as N,m as R,z as u,A as w,E as k,y as q,o as c,d as j}from"./ClNtL1l2.js";import{u as z}from"./C8iguzjs.js";const G={class:"max-w-5xl mx-auto px-4 py-10"},I={class:"flex items-center text-sm text-gray-500 mb-6","aria-label":"Breadcrumb"},H={class:"text-gray-800 font-medium"},J={class:"text-2xl sm:text-3xl font-bold mb-8"},K={class:"bg-white rounded-2xl border shadow-sm"},Q={class:"grid lg:grid-cols-[1fr_auto_1fr]"},W={class:"p-6 sm:p-8"},X={class:"text-xl font-semibold mb-4"},Y={class:"block text-sm text-gray-700 mb-1"},Z={class:"block text-sm text-gray-700 mb-1"},tt={class:"relative"},st=["type"],et=["disabled"],ot={key:0},at={key:1},nt={key:0,class:"text-red-600 text-sm"},lt={class:"p-6 sm:p-8"},it={class:"text-xl font-semibold mb-4"},rt={class:"grid sm:grid-cols-2 gap-3"},dt={class:"block text-sm text-gray-700 mb-1"},ut={class:"block text-sm text-gray-700 mb-1"},ct={class:"block text-sm text-gray-700 mb-1"},mt={class:"block text-sm text-gray-700 mb-1"},pt={class:"relative"},gt=["type"],ft={class:"block text-sm text-gray-700 mb-1"},xt=["type"],yt=["disabled"],bt={key:0},_t={key:1},ht={key:0,class:"text-red-600 text-sm"},Vt=B({__name:"login",setup(wt){const{t:o}=E(),L=D(),{$api:v}=F(),r=typeof V=="function"?V():null,x=z(),m=C({email:"",password:""}),y=p(!1),b=p(null),_=p(!1),n=C({first_name:"",last_name:"",email:"",password:"",password_confirmation:""}),h=p(!1),g=p(null),f=p(!1);async function P(){const i=x.snapshot();if(i.length){try{await v("/cart/merge",{method:"POST",body:{items:i}})}catch{}try{const e=await v("/cart",{method:"GET"});x.replace(Array.isArray(e?.items)?e.items:[])}catch{x.clear()}}}async function S(){b.value=null,y.value=!0;try{await r.login({email:m.email,password:m.password}),await x.afterAuthSync(),L.push("/")}catch(i){b.value=i?.data?.message||i?.message||"Login failed"}finally{y.value=!1}}async function A(){if(g.value=null,n.password!==n.password_confirmation){g.value=o("auth.passwordsNotMatch")||"Passwords do not match";return}h.value=!0;try{r&&typeof r.register=="function"?await r.register({...n,device:"web"}):(await v("/auth/register",{method:"POST",body:{...n,device:"web"}}),r&&typeof r.login=="function"&&await r.login(n.email,n.password)),await P(),L.push("/")}catch(i){g.value=i?.data?.message||i?.message||o("auth.registerFailed")||"Registration failed"}finally{h.value=!1}}return(i,e)=>{const U=T;return c(),d("div",G,[s("nav",I,[M(U,{to:"/",class:"hover:text-orange-500"},{default:O(()=>[j(a(t(o)("common.home")||"Home"),1)]),_:1}),e[9]||(e[9]=s("span",{class:"mx-2"},"›",-1)),s("span",H,a(t(o)("auth.login")||"Login"),1)]),s("h1",J,a(t(o)("auth.login")),1),s("div",K,[s("div",Q,[s("section",W,[s("h2",X,a(t(o)("auth.login")||"Login"),1),s("form",{class:"space-y-4",onSubmit:N(S,["prevent"])},[s("div",null,[s("label",Y,a(t(o)("common.email")||"Email"),1),u(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>t(m).email=l),type:"email",required:"",class:"w-full rounded-xl border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400"},null,512),[[w,t(m).email,void 0,{trim:!0}]])]),s("div",null,[s("label",Z,a(t(o)("auth.password")||"Password"),1),s("div",tt,[u(s("input",{type:t(_)?"text":"password","onUpdate:modelValue":e[1]||(e[1]=l=>t(m).password=l),required:"",class:"w-full rounded-xl border px-3 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-orange-400"},null,8,st),[[k,t(m).password]]),s("button",{type:"button",class:"absolute inset-y-0 right-2 my-auto text-gray-500",onClick:e[2]||(e[2]=l=>_.value=!t(_))},[s("span",{class:q(t(_)?"i-lucide:eye-off":"i-lucide:eye")},null,2)])])]),s("button",{class:"btn w-full",disabled:t(y)},[t(y)?(c(),d("span",at,a(t(o)("common.loading")||"Loading…"),1)):(c(),d("span",ot,a(t(o)("auth.login")||"Login"),1))],8,et),t(b)?(c(),d("p",nt,a(t(b)),1)):R("",!0)],32)]),e[10]||(e[10]=$('<div class="relative"><div class="hidden lg:block w-px h-full bg-gray-200"></div><div class="lg:hidden h-px w-full bg-gray-200"></div><div class="hidden lg:flex absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2"><span class="text-xs text-gray-500 bg-white px-2">OR</span></div><div class="lg:hidden flex justify-center"><span class="text-xs text-gray-500 bg-white px-2 -mt-3">OR</span></div></div>',1)),s("section",lt,[s("h2",it,a(t(o)("auth.register")||"Register"),1),s("form",{class:"space-y-4",onSubmit:N(A,["prevent"])},[s("div",rt,[s("div",null,[s("label",dt,a(t(o)("auth.firstName")||"First name"),1),u(s("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>t(n).first_name=l),type:"text",required:"",class:"w-full rounded-xl border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400"},null,512),[[w,t(n).first_name,void 0,{trim:!0}]])]),s("div",null,[s("label",ut,a(t(o)("auth.lastName")||"Last name"),1),u(s("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>t(n).last_name=l),type:"text",required:"",class:"w-full rounded-xl border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400"},null,512),[[w,t(n).last_name,void 0,{trim:!0}]])])]),s("div",null,[s("label",ct,a(t(o)("common.email")||"Email"),1),u(s("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>t(n).email=l),type:"email",required:"",class:"w-full rounded-xl border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400"},null,512),[[w,t(n).email,void 0,{trim:!0}]])]),s("div",null,[s("label",mt,a(t(o)("auth.password")||"Password"),1),s("div",pt,[u(s("input",{type:t(f)?"text":"password","onUpdate:modelValue":e[6]||(e[6]=l=>t(n).password=l),required:"",minlength:"6",class:"w-full rounded-xl border px-3 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-orange-400"},null,8,gt),[[k,t(n).password]]),s("button",{type:"button",class:"absolute inset-y-0 right-2 my-auto text-gray-500",onClick:e[7]||(e[7]=l=>f.value=!t(f))},[s("span",{class:q(t(f)?"i-lucide:eye-off":"i-lucide:eye")},null,2)])])]),s("div",null,[s("label",ft,a(t(o)("auth.confirmPassword")||"Confirm password"),1),u(s("input",{type:t(f)?"text":"password","onUpdate:modelValue":e[8]||(e[8]=l=>t(n).password_confirmation=l),required:"",minlength:"6",class:"w-full rounded-xl border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400"},null,8,xt),[[k,t(n).password_confirmation]])]),s("button",{class:"btn w-full",disabled:t(h)},[t(h)?(c(),d("span",_t,a(t(o)("common.loading")||"Loading…"),1)):(c(),d("span",bt,a(t(o)("auth.createAccount")||"Create account"),1))],8,yt),t(g)?(c(),d("p",ht,a(t(g)),1)):R("",!0)],32)])])])])}}});export{Vt as default};
