import{_ as O}from"./Dgi673JG.js";import{_ as R}from"./CV0r2NXO.js";import{i as E,e as z,B as G,C as K,j as W,f as i,q as J,l as Q,k as b,c as d,a as e,t as s,h as t,b as X,w as Z,p as j,z as p,A as M,y as P,G as T,m as g,F as ee,r as te,H as se,g as oe,o as c,d as ae,n as ne}from"./ClNtL1l2.js";import{u as re}from"./C8iguzjs.js";import{_ as le}from"./DlAUqK2U.js";const ce={class:"mx-auto max-w-6xl px-4 py-6 lg:py-10"},de={class:"mb-6 text-2xl sm:text-3xl font-bold tracking-tight"},ie={key:0,class:"rounded-2xl border border-dashed bg-white p-10 text-center text-gray-600"},ue={class:"mb-3 text-base"},me={key:1,class:"grid gap-6 lg:grid-cols-12"},pe={class:"lg:col-span-8 space-y-4"},he={class:"rounded-2xl border bg-white p-5 shadow-sm"},_e={class:"text-base font-semibold mb-4"},ye={class:"grid gap-4 sm:grid-cols-2"},xe={class:"block text-sm font-medium text-gray-700 mb-1"},fe={class:"grid gap-4 sm:grid-cols-2"},be={class:"block text-sm font-medium text-gray-700 mb-1"},ge=["value"],ve={class:"mt-1 text-xs text-gray-500"},ke={class:"block text-sm font-medium text-gray-700 mb-1"},we=["placeholder"],Pe={class:"pt-4 border-t"},Te={class:"text-sm font-semibold mb-2"},Ce={class:"space-y-2"},Ae={class:"flex items-start gap-3"},Ne={class:"text-sm"},Se={class:"font-medium"},Ue={class:"text-xs text-gray-600"},We={class:"flex-1 flex items-start gap-3"},je={class:"flex-1 text-sm"},Me={class:"font-medium"},Ve={class:"text-xs text-gray-600"},$e={key:0,class:"mt-2 text-xs text-gray-700 space-y-1"},Be={class:"font-semibold"},De={class:"rounded-lg bg-gray-100 px-3 py-2 break-all text-[11px] flex items-center justify-between gap-2"},Le={class:"truncate"},Ye={class:"ml-1"},qe={key:0,class:"text-[11px] text-emerald-600"},Fe={class:"text-[11px] text-gray-600"},He={class:"flex items-start gap-3"},Ie={class:"text-sm"},Oe={class:"font-medium"},Re={class:"text-xs text-gray-600"},Ee={class:"lg:col-span-4"},ze={class:"lg:sticky lg:top-24 overflow-hidden rounded-2xl border bg-white shadow-sm"},Ge={class:"border-b bg-gradient-to-r from-orange-100 to-amber-50 px-5 py-3"},Ke={class:"text-base font-semibold"},Je={class:"p-5 space-y-3"},Qe={class:"space-y-2 max-h-56 overflow-y-auto pr-1 text-sm"},Xe={class:"shrink-0"},Ze={key:1,class:"h-12 w-12 rounded-lg border bg-gray-50 grid place-items-center text-gray-400 text-xs"},et={class:"flex-1 min-w-0"},tt={class:"line-clamp-2 font-medium text-gray-900"},st={class:"text-xs text-gray-500"},ot={class:"text-right tabular-nums font-semibold"},at={class:"flex justify-between text-sm pt-2 border-t"},nt={class:"text-gray-600"},rt={class:"font-medium tabular-nums"},lt={class:"border-t pt-3 flex justify-between items-center"},ct={class:"text-base font-semibold"},dt={class:"text-2xl font-bold tabular-nums"},it={class:"text-[11px] text-gray-500 pt-1"},ut={class:"mt-3 space-y-2 border-t pt-3"},mt={class:"flex items-start gap-2 text-xs text-gray-700"},pt=["innerHTML"],ht={key:0,class:"rounded-xl bg-red-50 px-3 py-2 text-xs text-red-700"},_t={key:1,class:"rounded-xl bg-emerald-50 px-3 py-2 text-xs text-emerald-700"},yt=["disabled"],xt={key:0},ft={key:1},bt=E({__name:"checkout",setup(gt){const{t:o}=z(),V=re();G();const{$api:$}=K(),B=typeof W=="function"?W():null,v=i(()=>B?.user?.value),k=i(()=>v.value?.email||""),C=oe(),w=i(()=>C.public?.usdtWallet||""),D=i(()=>C.public?.whatsappNumber||""),_=i(()=>{const a=V?.items;return Array.isArray(a?.value)?a.value:Array.isArray(a)?a:[]}),A=i(()=>_.value.length),N=i(()=>_.value.reduce((a,r)=>a+Number(r?.price||0)*Number(r?.qty||0),0)),y=a=>Number(a||0).toFixed(2),L=a=>Number(a?.price||0)*Number(a?.qty||0),Y=a=>a?.id??`${a?.product_type}:${a?.product_id}`,q=a=>String(Y(a)),n=J({full_name:"",company:"",vat_number:"",notes:"",payment_method:"",accept_terms:!1});Q(()=>{if(v.value){const a=v.value;n.full_name=a.name||[a.first_name,a.last_name].filter(Boolean).join(" ")||""}});const h=b(!1),x=b(""),u=b(""),F=i(()=>o("checkout.acceptTermsHtml")||'I accept the <a href="/terms" class="text-orange-600 underline" target="_blank">terms &amp; conditions</a>.'),f=b(!1);async function H(){if(w.value)try{await navigator.clipboard.writeText(w.value),f.value=!0,setTimeout(()=>{f.value=!1},2e3)}catch(a){console.error("Failed to copy wallet address",a)}}const S=i(()=>!!n.full_name&&!!k.value&&!!n.payment_method&&n.accept_terms&&A.value>0&&!h.value);async function U(){if(S.value){h.value=!0,x.value="",u.value="";try{const a={full_name:n.full_name,company:n.company,vat_number:n.vat_number,notes:n.notes,payment_method:n.payment_method,accept_terms:n.accept_terms,email:k.value,items:_.value.map(m=>({id:m.id,product_id:m.product_id,qty:m.qty,unit_price:m.price}))},r=await $("/checkout",{method:"POST",body:a});n.payment_method==="paypal"?(u.value=o("checkout.successPaypal")||"Your PayPal invoice has been created. Redirecting you to PayPal...",r?.paypal_invoice_url?window.location.href=r.paypal_invoice_url:u.value=o("checkout.successPaypalNoUrl")||"Your PayPal invoice was created and sent to your email. Please check your inbox to pay."):n.payment_method==="usdt"?u.value=o("checkout.successUsdt")||"Your order has been created. Please send the USDT transfer and WhatsApp us the proof of payment.":u.value=o("checkout.successTransfer")||"Your order has been created. We will contact you with international transfer details."}catch(a){console.error(a),x.value=a?.data?.message||a?.message||o("checkout.error")||"Something went wrong while placing your order."}finally{h.value=!1}}}return(a,r)=>{const m=O,I=R;return c(),d("div",ce,[e("h1",de,s(t(o)("checkout.title")||"Checkout"),1),t(A)===0?(c(),d("div",ie,[e("p",ue,s(t(o)("checkout.empty")||"Your cart is empty. Add products before checking out."),1),X(m,{to:"/",class:"inline-flex items-center gap-2 rounded-xl border px-4 py-2 text-sm font-medium hover:bg-gray-50"},{default:Z(()=>[ae(" ← "+s(t(o)("common.continueShopping")||"Continue shopping"),1)]),_:1})])):(c(),d("div",me,[e("section",pe,[e("div",he,[e("h2",_e,s(t(o)("checkout.details")||"Billing details"),1),e("form",{class:"space-y-4",onSubmit:j(U,["prevent"])},[e("div",ye,[e("div",null,[e("label",xe,s(t(o)("checkout.fullName")||"Full name"),1),p(e("input",{"onUpdate:modelValue":r[0]||(r[0]=l=>t(n).full_name=l),type:"text",class:"w-full rounded-xl border px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-orange-500",required:""},null,512),[[M,t(n).full_name]])])]),e("div",fe,[e("div",null,[e("label",be,s(t(o)("checkout.email")||"Email"),1),e("input",{value:t(k),type:"email",disabled:"",class:"w-full rounded-xl border px-3 py-2 text-sm bg-gray-50 text-gray-500 cursor-not-allowed"},null,8,ge),e("p",ve,s(t(o)("checkout.emailFromAccount")||"Your email comes from your account and cannot be changed here."),1)])]),e("div",null,[e("label",ke,s(t(o)("checkout.notes")||"Order notes (optional)"),1),p(e("textarea",{"onUpdate:modelValue":r[1]||(r[1]=l=>t(n).notes=l),rows:"3",class:"w-full rounded-xl border px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-orange-500",placeholder:t(o)("checkout.notesPlaceholder")||"Any special instructions…"},null,8,we),[[M,t(n).notes]])]),e("div",Pe,[e("h3",Te,s(t(o)("checkout.paymentMethod")||"Payment method"),1),e("div",Ce,[e("label",{class:P(["flex items-start gap-3 p-3 rounded-xl border cursor-pointer hover:border-orange-400 transition",{"border-orange-500 bg-orange-50/40":t(n).payment_method==="paypal"}])},[p(e("input",{type:"radio",value:"paypal","onUpdate:modelValue":r[2]||(r[2]=l=>t(n).payment_method=l),class:"mt-1"},null,512),[[T,t(n).payment_method]]),e("div",Ae,[r[6]||(r[6]=e("div",{class:"mt-0.5 h-8 w-8 rounded-full bg-[#00457C] text-white flex items-center justify-center text-xs font-semibold"}," P ",-1)),e("div",Ne,[e("div",Se,s(t(o)("checkout.methods.paypal.title")||"PayPal"),1),e("div",Ue,s(t(o)("checkout.methods.paypal.desc")||"An invoice will be created in PayPal and sent to your email."),1)])])],2),e("label",{class:P(["flex items-start gap-3 p-3 rounded-xl border cursor-pointer hover:border-orange-400 transition",{"border-orange-500 bg-orange-50/40":t(n).payment_method==="usdt"}])},[p(e("input",{type:"radio",value:"usdt","onUpdate:modelValue":r[3]||(r[3]=l=>t(n).payment_method=l),class:"mt-1"},null,512),[[T,t(n).payment_method]]),e("div",We,[r[8]||(r[8]=e("div",{class:"mt-0.5 h-8 w-8 rounded-full bg-emerald-600 text-white flex items-center justify-center text-xs font-semibold"}," ₮ ",-1)),e("div",je,[e("div",Me,s(t(o)("checkout.methods.usdt.title")||"USDT transfer"),1),e("div",Ve,s(t(o)("checkout.methods.usdt.desc")||"Send USDT to our wallet and WhatsApp us the proof of payment."),1),t(n).payment_method==="usdt"?(c(),d("div",$e,[e("div",Be,s(t(o)("checkout.methods.usdt.walletLabel")||"USDT wallet address"),1),e("div",De,[e("span",Le,s(t(w)||"USDT WALLET !"),1),e("button",{type:"button",class:"inline-flex items-center rounded-lg border border-gray-300 bg-white px-2 py-1 text-[11px] font-medium hover:bg-gray-50",onClick:j(H,["stop"])},[r[7]||(r[7]=e("svg",{class:"h-3 w-3",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})],-1)),e("span",Ye,s(t(f)?t(o)("checkout.copied")||"Copied":t(o)("checkout.copy")||"Copy"),1)])]),t(f)?(c(),d("div",qe,s(t(o)("checkout.walletCopied")||"Wallet address copied to clipboard."),1)):g("",!0),e("div",Fe,s(t(o)("checkout.methods.usdt.afterPayment",{phone:t(D)||"WhatsApp"})||"After sending USDT, please send the payment proof to us on WhatsApp."),1)])):g("",!0)])])],2),e("label",{class:P(["flex items-start gap-3 p-3 rounded-xl border cursor-pointer hover:border-orange-400 transition",{"border-orange-500 bg-orange-50/40":t(n).payment_method==="transfer"}])},[p(e("input",{type:"radio",value:"transfer","onUpdate:modelValue":r[4]||(r[4]=l=>t(n).payment_method=l),class:"mt-1"},null,512),[[T,t(n).payment_method]]),e("div",He,[r[9]||(r[9]=e("div",{class:"mt-0.5 h-8 w-8 rounded-full bg-slate-700 text-white flex items-center justify-center text-xs font-semibold"}," $ ",-1)),e("div",Ie,[e("div",Oe,s(t(o)("checkout.methods.transfer.title")||"International transfer"),1),e("div",Re,s(t(o)("checkout.methods.transfer.desc")||"You can pay via Western Union or international bank transfer. We will send you the details after you place the order."),1)])])],2)])])],32)])]),e("aside",Ee,[e("div",ze,[e("div",Ge,[e("h2",Ke,s(t(o)("checkout.summary")||"Order summary"),1)]),e("div",Je,[e("ul",Qe,[(c(!0),d(ee,null,te(t(_),l=>(c(),d("li",{key:q(l),class:"flex items-start justify-between gap-3"},[e("div",Xe,[l?.image?(c(),ne(I,{key:0,src:l.image,width:"48",height:"48",modifiers:{fit:"cover"},class:"h-12 w-12 rounded-lg border bg-gray-50 object-cover",alt:""},null,8,["src"])):(c(),d("div",Ze," — "))]),e("div",et,[e("div",tt,s(l?.name),1),e("div",st," x"+s(l?.qty)+" · $"+s(y(l?.price)),1)]),e("div",ot," $"+s(y(L(l))),1)]))),128))]),e("div",at,[e("span",nt,s(t(o)("cart.subtotal")||"Subtotal"),1),e("span",rt," $"+s(y(t(N))),1)]),e("div",lt,[e("span",ct,s(t(o)("cart.total")||"Total"),1),e("span",dt," $"+s(y(t(N))),1)]),e("p",it,s(t(o)("checkout.info")||"You will be contacted or redirected to complete the payment after placing your order."),1),e("div",ut,[e("label",mt,[p(e("input",{"onUpdate:modelValue":r[5]||(r[5]=l=>t(n).accept_terms=l),type:"checkbox",class:"mt-0.5"},null,512),[[se,t(n).accept_terms]]),e("span",{innerHTML:t(F)},null,8,pt)]),t(x)?(c(),d("div",ht,s(t(x)),1)):g("",!0),t(u)?(c(),d("div",_t,s(t(u)),1)):g("",!0),e("button",{type:"button",class:"btn-primary w-full mt-1",disabled:t(h)||!t(S),onClick:U},[t(h)?(c(),d("span",xt,s(t(o)("checkout.placing")||"Placing order…"),1)):(c(),d("span",ft,s(t(o)("checkout.placeOrder")||"Place order"),1))],8,yt)])])])])]))])}}}),Ct=le(bt,[["__scopeId","data-v-8dac0de8"]]);export{Ct as default};
