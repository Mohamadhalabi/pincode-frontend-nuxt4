import{_ as P}from"./Dgi673JG.js";import{_ as R}from"./CV0r2NXO.js";import{i as U,e as Y,j as E,f as k,k as V,l as H,c as d,o as r,a as e,t as n,h as s,b as g,w as y,d as b,m as w,F as C,r as I,n as N,p as f}from"./ClNtL1l2.js";import{u as O}from"./C8iguzjs.js";const z={class:"mx-auto max-w-6xl px-4 py-6 lg:py-10"},G={class:"mb-6 text-2xl sm:text-3xl font-bold tracking-tight"},J={key:0,class:"rounded-2xl border border-dashed bg-white p-10 text-center text-gray-600"},W={class:"mb-3 text-base"},X={key:1,class:"grid gap-6 lg:grid-cols-12"},Z={class:"lg:col-span-8 space-y-4"},ee={key:0,class:"space-y-4"},te={key:1,class:"hidden md:block rounded-2xl border bg-white shadow-sm overflow-hidden"},se={class:"w-full text-sm"},oe={class:"bg-gray-50 text-gray-600"},ne={class:"px-4 py-3 text-left font-medium w-[520px]"},ae={class:"px-3 py-3 text-right font-medium"},le={class:"px-3 py-3 text-center font-medium"},re={class:"px-3 py-3 text-center font-medium"},ce={class:"px-3 py-3 text-right font-medium"},de={class:"px-4 py-3 text-right font-medium w-[80px]"},ie={class:"px-4 py-4"},ue={class:"flex items-start gap-3"},pe={key:1,class:"h-20 w-20 rounded-xl border bg-gray-50 grid place-items-center text-gray-400"},me={class:"min-w-0"},_e={class:"mt-1 flex flex-wrap items-center gap-2 text-xs"},he={key:0,class:"inline-flex rounded-full bg-gray-100 px-2 py-0.5 text-gray-700"},ye={class:"inline-flex rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-emerald-700"},be={class:"px-3 py-4 text-right tabular-nums"},xe={class:"px-3 py-4"},ge={class:"flex justify-center"},fe={class:"inline-flex items-center rounded-full border bg-white px-1 shadow-sm"},ve=["disabled","onClick"],ke=["value","disabled","onInput","onBlur"],we=["disabled","onClick"],Ce={class:"px-3 py-4 text-center"},$e={key:0,class:"tabular-nums"},Ie={key:1},Ne={class:"px-3 py-4 text-right text-base font-semibold tabular-nums"},qe={class:"px-4 py-4 text-right"},Be=["disabled","onClick"],Se={key:2,class:"md:hidden space-y-3"},je={class:"flex items-start gap-3"},Le={key:1,class:"h-24 w-24 rounded-xl border bg-gray-50 grid place-items-center text-gray-400"},Te={class:"min-w-0 flex-1"},Ae={class:"mt-1 flex flex-wrap items-center gap-2 text-xs"},Qe={key:0,class:"rounded-full bg-gray-100 px-2 py-0.5 text-gray-700"},Me={class:"rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-emerald-700"},Ve={class:"mt-3 flex items-center justify-between"},De={class:"inline-flex items-center rounded-full border bg-white px-1 shadow-sm"},Fe=["disabled","onClick"],Ke=["value","disabled","onInput","onBlur"],Pe=["disabled","onClick"],Re={class:"text-right"},Ue={class:"text-[11px] uppercase tracking-wide text-gray-500"},Ye={class:"text-lg font-semibold"},Ee={class:"mt-2"},He=["disabled","onClick"],Oe={key:0,class:"flex items-center justify-between pt-1"},ze={class:"lg:col-span-4"},Ge={class:"lg:sticky lg:top-24 overflow-hidden rounded-2xl border bg-white shadow-sm"},Je={class:"border-b bg-gradient-to-r from-orange-100 to-amber-50 px-5 py-3"},We={class:"text-base font-semibold"},Xe={class:"p-5 space-y-3"},Ze={class:"flex justify-between text-sm"},et={class:"text-gray-600"},tt={class:"font-medium tabular-nums"},st={class:"border-t pt-3 flex justify-between items-center"},ot={class:"text-base font-semibold"},nt={class:"text-2xl font-bold tabular-nums"},at={class:"mt-1 text-xs text-gray-500"},ut=U({__name:"cart",setup(lt){const{t:a}=Y(),l=O(),D=E(),F=k(()=>D.isLoggedIn.value),_=k(()=>{const o=l?.items;return Array.isArray(o?.value)?o.value:Array.isArray(o)?o:[]}),q=k(()=>_.value.length),v=V(!1);H(()=>{v.value=!0});const B=k(()=>_.value.reduce((o,i)=>o+Number(i?.price||0)*Number(i?.qty||0),0)),h=o=>Number(o||0).toFixed(2),S=o=>Number(o?.price||0)*Number(o?.qty||0),p=o=>o?.id??`${o?.product_type}:${o?.product_id}`,j=o=>String(p(o)),m=V(null);async function $(o,i){i=Math.max(1,Number(i)||1);const c=p(o);m.value=c;try{o.qty=i,typeof l.setQty=="function"?await l.setQty(o,i):typeof l.update=="function"?await l.update(o,{qty:i}):l.sync?.(),typeof l.reload=="function"&&await l.reload()}catch(x){console.error(x)}finally{m.value=null}}async function L(o){const i=p(o);m.value=i;try{const c=_.value.findIndex(x=>p(x)===i);c>-1&&_.value.splice(c,1),typeof l.remove=="function"?await l.remove(o):typeof l.removeItem=="function"?await l.removeItem(o):l.sync?.(),typeof l.reload=="function"&&await l.reload()}catch(c){console.error(c),typeof l.reload=="function"&&await l.reload()}finally{m.value=null}}function T(o){$(o,Number(o?.qty||1)-1)}function A(o){$(o,Number(o?.qty||1)+1)}function Q(o,i){const c=o.target.value.replace(/[^\d]/g,"");o.target.value=c,i.qty=Math.max(1,Number(c)||1)}function M(o,i){const c=Number(o.target.value||1);$(i,c)}function K(){confirm(a("cart.clearConfirm")||"Clear all items from cart?")&&(typeof l.clear=="function"?l.clear():_.value.splice(0,_.value.length),l.sync?.(),typeof l.reload=="function"&&l.reload())}return(o,i)=>{const c=P,x=R;return r(),d("div",z,[e("h1",G,n(s(a)("cart.title")||"Cart"),1),s(v)&&s(q)===0?(r(),d("div",J,[e("p",W,n(s(a)("cart.empty")||"Your cart is empty."),1),g(c,{to:"/",class:"inline-flex items-center gap-2 rounded-xl border px-4 py-2 text-sm font-medium hover:bg-gray-50"},{default:y(()=>[b(" ← "+n(s(a)("common.continueShopping")||"Continue shopping"),1)]),_:1})])):(r(),d("div",X,[e("section",Z,[s(v)?(r(),d("div",te,[e("table",se,[e("thead",oe,[e("tr",null,[e("th",ne,n(s(a)("cart.product")||"Product"),1),e("th",ae,n(s(a)("cart.price")||"Price"),1),e("th",le,n(s(a)("cart.qty")||"Qty"),1),e("th",re,n(s(a)("tokens")||"Tokens"),1),e("th",ce,n(s(a)("cart.lineTotal")||"Line total"),1),e("th",de,n(s(a)("cart.actions")||"Actions"),1)])]),e("tbody",null,[(r(!0),d(C,null,I(s(_),t=>(r(),d("tr",{key:j(t),class:"border-t hover:bg-gray-50/60 transition-colors"},[e("td",ie,[e("div",ue,[t?.image?(r(),N(x,{key:0,src:t.image,width:"80",height:"80",modifiers:{fit:"cover"},class:"h-20 w-20 rounded-xl border bg-gray-50 object-cover",alt:""},null,8,["src"])):(r(),d("div",pe,"—")),e("div",me,[g(c,{to:`/product/${t?.slug}`,class:"line-clamp-2 font-semibold leading-6 hover:underline text-gray-900"},{default:y(()=>[b(n(t?.name),1)]),_:2},1032,["to"]),e("div",_e,[t?.sku?(r(),d("span",he,"SKU: "+n(t.sku),1)):w("",!0),e("span",ye,"$"+n(h(t?.price))+" / "+n(s(a)("cart.unit")||"unit"),1)])])])]),e("td",be,"$"+n(h(t?.price)),1),e("td",xe,[e("div",ge,[e("div",fe,[e("button",{type:"button",class:"h-8 w-8 grid place-items-center rounded-full hover:bg-gray-50 disabled:opacity-50 text-gray-700 text-lg font-semibold leading-none",disabled:s(m)===p(t),onClick:f(u=>T(t),["stop"]),"aria-label":"Decrease quantity"},"−",8,ve),e("input",{value:t?.qty,inputmode:"numeric",pattern:"[0-9]*",class:"h-8 w-14 border-x border-gray-200 text-center outline-none disabled:opacity-60",disabled:s(m)===p(t),onInput:u=>Q(u,t),onBlur:u=>M(u,t)},null,40,ke),e("button",{type:"button",class:"h-8 w-8 grid place-items-center rounded-full hover:bg-gray-50 disabled:opacity-50 text-gray-700 text-lg font-semibold leading-none",disabled:s(m)===p(t),onClick:f(u=>A(t),["stop"]),"aria-label":"Increase quantity"},"+",8,we)])])]),e("td",Ce,[t?.meta?.tokens?(r(),d("span",$e,n(t?.qty*t.meta.tokens),1)):(r(),d("span",Ie,"—"))]),e("td",Ne," $"+n(h(S(t))),1),e("td",qe,[e("button",{class:"text-sm text-red-600 hover:underline disabled:opacity-50",disabled:s(m)===p(t),onClick:f(u=>L(t),["stop"])},n(s(a)("cart.remove")||"Remove"),9,Be)])]))),128))])])])):(r(),d("div",ee,[(r(),d(C,null,I(3,t=>e("div",{key:t,class:"h-32 rounded-2xl border bg-gray-50 animate-pulse"})),64))])),s(v)?(r(),d("div",Se,[(r(!0),d(C,null,I(s(_),t=>(r(),d("div",{key:j(t),class:"rounded-2xl border bg-white p-3 shadow-sm"},[e("div",je,[t?.image?(r(),N(x,{key:0,src:t.image,width:"96",height:"96",modifiers:{fit:"cover"},class:"h-24 w-24 rounded-xl border bg-gray-50 object-cover",alt:""},null,8,["src"])):(r(),d("div",Le,"—")),e("div",Te,[g(c,{to:`/product/${t?.slug}`,class:"line-clamp-2 font-semibold leading-6 hover:underline"},{default:y(()=>[b(n(t?.name),1)]),_:2},1032,["to"]),e("div",Ae,[t?.sku?(r(),d("span",Qe,"SKU: "+n(t.sku),1)):w("",!0),e("span",Me," $"+n(h(t?.price))+" / "+n(s(a)("cart.unit")||"unit"),1)]),e("div",Ve,[e("div",De,[e("button",{type:"button",class:"h-8 w-8 grid place-items-center rounded-full hover:bg-gray-50 disabled:opacity-50 text-gray-700 text-lg font-semibold leading-none",disabled:s(m)===p(t),onClick:f(u=>T(t),["stop"]),"aria-label":"Decrease quantity"},"−",8,Fe),e("input",{value:t?.qty,inputmode:"numeric",pattern:"[0-9]*",class:"h-8 w-14 border-x border-gray-200 text-center outline-none disabled:opacity-60",disabled:s(m)===p(t),onInput:u=>Q(u,t),onBlur:u=>M(u,t)},null,40,Ke),e("button",{type:"button",class:"h-8 w-8 grid place-items-center rounded-full hover:bg-gray-50 disabled:opacity-50 text-gray-700 text-lg font-semibold leading-none",disabled:s(m)===p(t),onClick:f(u=>A(t),["stop"]),"aria-label":"Increase quantity"},"+",8,Pe)]),e("div",Re,[e("div",Ue,n(s(a)("cart.lineTotal")||"Line total"),1),e("div",Ye,"$"+n(h(S(t))),1)])]),e("div",Ee,[e("button",{class:"text-sm text-red-600 hover:underline disabled:opacity-50",disabled:s(m)===p(t),onClick:f(u=>L(t),["stop"])},n(s(a)("cart.remove")||"Remove"),9,He)])])])]))),128)),s(q)?(r(),d("div",Oe,[g(c,{to:"/",class:"text-sm text-gray-700 hover:underline"},{default:y(()=>[b(" ← "+n(s(a)("common.continueShopping")||"Continue shopping"),1)]),_:1}),e("button",{type:"button",class:"text-sm text-red-600 hover:underline",onClick:K},n(s(a)("cart.clear")||"Clear cart"),1)])):w("",!0)])):w("",!0)]),e("aside",ze,[e("div",Ge,[e("div",Je,[e("h2",We,n(s(a)("cart.summary")||"Order Summary"),1)]),e("div",Xe,[e("div",Ze,[e("span",et,n(s(a)("cart.subtotal")||"Subtotal"),1),e("span",tt,"$"+n(h(s(B))),1)]),e("div",st,[e("span",ot,n(s(a)("cart.total")||"Total"),1),e("span",nt,"$"+n(h(s(B))),1)]),s(F)?(r(),N(c,{key:0,to:"/checkout",class:"btn-primary w-full mt-2"},{default:y(()=>[b(n(s(a)("cart.checkout")||"Proceed to Checkout"),1)]),_:1})):(r(),d(C,{key:1},[g(c,{to:"/login",class:"btn-primary w-full mt-2"},{default:y(()=>[b(n(s(a)("cart.loginToCheckout")||"Login to checkout"),1)]),_:1}),e("p",at,n(s(a)("cart.loginToCheckoutHint")||"You need to login to complete your purchase."),1)],64)),g(c,{to:"/",class:"btn-ghost w-full text-center"},{default:y(()=>[b(n(s(a)("common.continueShopping")||"Continue shopping"),1)]),_:1})])])])]))])}}});export{ut as default};
