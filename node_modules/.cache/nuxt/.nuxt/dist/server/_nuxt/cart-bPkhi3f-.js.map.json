{"file":"cart-bPkhi3f-.js","mappings":"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","names":["_ssrRenderAttrs","_mergeProps","_unref","_push","_parent","_createTextVNode","_ssrRenderList","_ssrInterpolate","_toDisplayString"],"sources":["../../../../../../../pages/cart.vue"],"sourcesContent":["<!-- pages/cart.vue -->\n<template>\n  <div class=\"mx-auto max-w-6xl px-4 py-6 lg:py-10\">\n    <h1 class=\"mb-6 text-2xl sm:text-3xl font-bold tracking-tight\">\n      {{ t('cart.title') || 'Cart' }}\n    </h1>\n\n    <!-- Empty -->\n    <div\n      v-if=\"mounted && itemsLen === 0\"\n      class=\"rounded-2xl border border-dashed bg-white p-10 text-center text-gray-600\"\n    >\n      <p class=\"mb-3 text-base\">{{ t('cart.empty') || 'Your cart is empty.' }}</p>\n      <NuxtLink\n        to=\"/\"\n        class=\"inline-flex items-center gap-2 rounded-xl border px-4 py-2 text-sm font-medium hover:bg-gray-50\"\n      >\n        ← {{ t('common.continueShopping') || 'Continue shopping' }}\n      </NuxtLink>\n    </div>\n\n    <!-- Content -->\n    <div v-else class=\"grid gap-6 lg:grid-cols-12\">\n      <!-- Items (Table on md+, cards on mobile) -->\n      <section class=\"lg:col-span-8 space-y-4\">\n        <!-- Skeleton -->\n        <div v-if=\"!mounted\" class=\"space-y-4\">\n          <div v-for=\"i in 3\" :key=\"i\" class=\"h-32 rounded-2xl border bg-gray-50 animate-pulse\" />\n        </div>\n\n        <!-- Table (md+) -->\n        <div v-else class=\"hidden md:block rounded-2xl border bg-white shadow-sm overflow-hidden\">\n          <table class=\"w-full text-sm\">\n            <thead class=\"bg-gray-50 text-gray-600\">\n              <tr>\n                <th class=\"px-4 py-3 text-left font-medium w-[520px]\">{{ t('cart.product') || 'Product' }}</th>\n                <th class=\"px-3 py-3 text-right font-medium\">{{ t('cart.price') || 'Price' }}</th>\n                <th class=\"px-3 py-3 text-center font-medium\">{{ t('cart.qty') || 'Qty' }}</th>\n                <th class=\"px-3 py-3 text-center font-medium\">{{ t('tokens') || 'Tokens' }}</th>\n                <th class=\"px-3 py-3 text-right font-medium\">{{ t('cart.lineTotal') || 'Line total' }}</th>\n                <th class=\"px-4 py-3 text-right font-medium w-[80px]\">{{ t('cart.actions') || 'Actions' }}</th>\n              </tr>\n            </thead>\n\n            <tbody>\n              <tr\n                v-for=\"it in itemsRef\"\n                :key=\"rowKey(it)\"\n                class=\"border-t hover:bg-gray-50/60 transition-colors\"\n              >\n                <!-- Product -->\n                <td class=\"px-4 py-4\">\n                  <div class=\"flex items-start gap-3\">\n                    <NuxtImg\n                      v-if=\"it?.image\"\n                      :src=\"it.image\"\n                      width=\"80\" height=\"80\"\n                      :modifiers=\"{ fit: 'cover' }\"\n                      class=\"h-20 w-20 rounded-xl border bg-gray-50 object-cover\"\n                      alt=\"\"\n                    />\n                    <div v-else class=\"h-20 w-20 rounded-xl border bg-gray-50 grid place-items-center text-gray-400\">—</div>\n\n                    <div class=\"min-w-0\">\n                      <NuxtLink\n                        :to=\"`/product/${it?.slug}`\"\n                        class=\"line-clamp-2 font-semibold leading-6 hover:underline text-gray-900\"\n                      >\n                        {{ it?.name }}\n                      </NuxtLink>\n                      <div class=\"mt-1 flex flex-wrap items-center gap-2 text-xs\">\n                        <span\n                          v-if=\"it?.sku\"\n                          class=\"inline-flex rounded-full bg-gray-100 px-2 py-0.5 text-gray-700\"\n                        >SKU: {{ it.sku }}</span>\n                        <span\n                          class=\"inline-flex rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-emerald-700\"\n                        >${{ price(it?.price) }} / {{ t('cart.unit') || 'unit' }}</span>\n                      </div>\n                    </div>\n                  </div>\n                </td>\n\n                <!-- Price -->\n                <td class=\"px-3 py-4 text-right tabular-nums\">${{ price(it?.price) }}</td>\n\n                <!-- Qty -->\n                <td class=\"px-3 py-4\">\n                  <div class=\"flex justify-center\">\n                    <div class=\"inline-flex items-center rounded-full border bg-white px-1 shadow-sm\">\n                      <button\n                        type=\"button\"\n                        class=\"h-8 w-8 grid place-items-center rounded-full hover:bg-gray-50 disabled:opacity-50 text-gray-700 text-lg font-semibold leading-none\"\n                        :disabled=\"busyId === cartId(it)\"\n                        @click.stop=\"dec(it)\"\n                        aria-label=\"Decrease quantity\"\n                      >−</button>\n\n                      <input\n                        :value=\"it?.qty\"\n                        inputmode=\"numeric\"\n                        pattern=\"[0-9]*\"\n                        class=\"h-8 w-14 border-x border-gray-200 text-center outline-none disabled:opacity-60\"\n                        :disabled=\"busyId === cartId(it)\"\n                        @input=\"onQtyInput($event, it)\"\n                        @blur=\"onQtyBlur($event, it)\"\n                      />\n\n                      <button\n                        type=\"button\"\n                        class=\"h-8 w-8 grid place-items-center rounded-full hover:bg-gray-50 disabled:opacity-50 text-gray-700 text-lg font-semibold leading-none\"\n                        :disabled=\"busyId === cartId(it)\"\n                        @click.stop=\"inc(it)\"\n                        aria-label=\"Increase quantity\"\n                      >+</button>\n                    </div>\n                  </div>\n                </td>\n\n                <!-- Tokens -->\n                <td class=\"px-3 py-4 text-center\">\n                  <span v-if=\"it?.meta?.tokens\" class=\"tabular-nums\">\n                    {{ it?.qty * it.meta.tokens }}\n                  </span>\n                  <span v-else>—</span>\n                </td>\n\n                <!-- Line total -->\n                <td class=\"px-3 py-4 text-right text-base font-semibold tabular-nums\">\n                  ${{ price(lineTotal(it)) }}\n                </td>\n\n                <!-- Actions -->\n                <td class=\"px-4 py-4 text-right\">\n                  <button\n                    class=\"text-sm text-red-600 hover:underline disabled:opacity-50\"\n                    :disabled=\"busyId === cartId(it)\"\n                    @click.stop=\"removeItem(it)\"\n                  >\n                    {{ t('cart.remove') || 'Remove' }}\n                  </button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n\n        <!-- Mobile cards (< md) -->\n        <div v-if=\"mounted\" class=\"md:hidden space-y-3\">\n          <div\n            v-for=\"it in itemsRef\"\n            :key=\"rowKey(it)\"\n            class=\"rounded-2xl border bg-white p-3 shadow-sm\"\n          >\n            <div class=\"flex items-start gap-3\">\n              <NuxtImg\n                v-if=\"it?.image\"\n                :src=\"it.image\"\n                width=\"96\" height=\"96\"\n                :modifiers=\"{ fit: 'cover' }\"\n                class=\"h-24 w-24 rounded-xl border bg-gray-50 object-cover\"\n                alt=\"\"\n              />\n              <div v-else class=\"h-24 w-24 rounded-xl border bg-gray-50 grid place-items-center text-gray-400\">—</div>\n\n              <div class=\"min-w-0 flex-1\">\n                <NuxtLink :to=\"`/product/${it?.slug}`\" class=\"line-clamp-2 font-semibold leading-6 hover:underline\">\n                  {{ it?.name }}\n                </NuxtLink>\n                <div class=\"mt-1 flex flex-wrap items-center gap-2 text-xs\">\n                  <span v-if=\"it?.sku\" class=\"rounded-full bg-gray-100 px-2 py-0.5 text-gray-700\">SKU: {{ it.sku }}</span>\n                  <span class=\"rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-emerald-700\">\n                    ${{ price(it?.price) }} / {{ t('cart.unit') || 'unit' }}\n                  </span>\n                </div>\n\n                <div class=\"mt-3 flex items-center justify-between\">\n                  <div class=\"inline-flex items-center rounded-full border bg-white px-1 shadow-sm\">\n                    <button\n                      type=\"button\"\n                      class=\"h-8 w-8 grid place-items-center rounded-full hover:bg-gray-50 disabled:opacity-50 text-gray-700 text-lg font-semibold leading-none\"\n                      :disabled=\"busyId === cartId(it)\"\n                      @click.stop=\"dec(it)\"\n                      aria-label=\"Decrease quantity\"\n                    >−</button>\n                    <input\n                      :value=\"it?.qty\"\n                      inputmode=\"numeric\"\n                      pattern=\"[0-9]*\"\n                      class=\"h-8 w-14 border-x border-gray-200 text-center outline-none disabled:opacity-60\"\n                      :disabled=\"busyId === cartId(it)\"\n                      @input=\"onQtyInput($event, it)\"\n                      @blur=\"onQtyBlur($event, it)\"\n                    />\n                    <button\n                      type=\"button\"\n                      class=\"h-8 w-8 grid place-items-center rounded-full hover:bg-gray-50 disabled:opacity-50 text-gray-700 text-lg font-semibold leading-none\"\n                      :disabled=\"busyId === cartId(it)\"\n                      @click.stop=\"inc(it)\"\n                      aria-label=\"Increase quantity\"\n                    >+</button>\n                  </div>\n\n                  <div class=\"text-right\">\n                    <div class=\"text-[11px] uppercase tracking-wide text-gray-500\">\n                      {{ t('cart.lineTotal') || 'Line total' }}\n                    </div>\n                    <div class=\"text-lg font-semibold\">${{ price(lineTotal(it)) }}</div>\n                  </div>\n                </div>\n\n                <div class=\"mt-2\">\n                  <button\n                    class=\"text-sm text-red-600 hover:underline disabled:opacity-50\"\n                    :disabled=\"busyId === cartId(it)\"\n                    @click.stop=\"removeItem(it)\"\n                  >\n                    {{ t('cart.remove') || 'Remove' }}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div v-if=\"itemsLen\" class=\"flex items-center justify-between pt-1\">\n            <NuxtLink to=\"/\" class=\"text-sm text-gray-700 hover:underline\">\n              ← {{ t('common.continueShopping') || 'Continue shopping' }}\n            </NuxtLink>\n            <button type=\"button\" class=\"text-sm text-red-600 hover:underline\" @click=\"clearAll\">\n              {{ t('cart.clear') || 'Clear cart' }}\n            </button>\n          </div>\n        </div>\n      </section>\n\n      <!-- Summary -->\n      <aside class=\"lg:col-span-4\">\n        <div class=\"lg:sticky lg:top-24 overflow-hidden rounded-2xl border bg-white shadow-sm\">\n          <div class=\"border-b bg-gradient-to-r from-orange-100 to-amber-50 px-5 py-3\">\n            <h2 class=\"text-base font-semibold\">{{ t('cart.summary') || 'Order Summary' }}</h2>\n          </div>\n\n          <div class=\"p-5 space-y-3\">\n            <div class=\"flex justify-between text-sm\">\n              <span class=\"text-gray-600\">{{ t('cart.subtotal') || 'Subtotal' }}</span>\n              <span class=\"font-medium tabular-nums\">${{ price(subtotal) }}</span>\n            </div>\n\n            <div class=\"border-t pt-3 flex justify-between items-center\">\n              <span class=\"text-base font-semibold\">{{ t('cart.total') || 'Total' }}</span>\n              <span class=\"text-2xl font-bold tabular-nums\">${{ price(subtotal) }}</span>\n            </div>\n\n            <!-- If logged in: go to checkout -->\n            <template v-if=\"isLoggedIn\">\n              <NuxtLink to=\"/checkout\" class=\"btn-primary w-full mt-2\">\n                {{ t('cart.checkout') || 'Proceed to Checkout' }}\n              </NuxtLink>\n            </template>\n\n            <!-- If NOT logged in: force login first -->\n            <template v-else>\n              <NuxtLink to=\"/login\" class=\"btn-primary w-full mt-2\">\n                {{ t('cart.loginToCheckout') || 'Login to checkout' }}\n              </NuxtLink>\n              <p class=\"mt-1 text-xs text-gray-500\">\n                {{ t('cart.loginToCheckoutHint') || 'You need to login to complete your purchase.' }}\n              </p>\n            </template>\n\n            <NuxtLink to=\"/\" class=\"btn-ghost w-full text-center\">\n              {{ t('common.continueShopping') || 'Continue shopping' }}\n            </NuxtLink>\n          </div>\n        </div>\n      </aside>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nconst { t } = useI18n()\nconst cart = useCart()\n\n// --- Auth state (logged-in or not) using useAuth composable ---\nconst auth = useAuth()\nconst isLoggedIn = computed(() => auth.isLoggedIn.value)\n\n/** Normalize to an always-array ref */\nconst itemsRef = computed<any[]>(() => {\n  const raw = (cart as any)?.items\n  if (Array.isArray(raw?.value)) return raw.value as any[]\n  if (Array.isArray(raw)) return raw as any[]\n  return [] as any[]\n})\nconst itemsLen = computed(() => itemsRef.value.length)\n\nconst mounted = ref(false)\nonMounted(() => { mounted.value = true })\n\n/** Summary */\nconst subtotal = computed(() =>\n  itemsRef.value.reduce((sum, i: any) => sum + Number(i?.price || 0) * Number(i?.qty || 0), 0)\n)\n\n/** Helpers */\nconst price = (n: number | string) => Number(n || 0).toFixed(2)\nconst lineTotal = (it: any) => Number(it?.price || 0) * Number(it?.qty || 0)\n\n/** Prefer server cart item id if present; fallback to composite key for guest cart */\nconst cartId = (it: any) => (it?.id ?? `${it?.product_type}:${it?.product_id}`)\nconst rowKey = (it: any) => String(cartId(it))\n\n/** Busy state per item to prevent double clicks */\nconst busyId = ref<string | number | null>(null)\n\n/** Core mutations */\nasync function setQty(it: any, qty: number) {\n  qty = Math.max(1, Number(qty) || 1)\n  const id = cartId(it)\n  busyId.value = id\n  try {\n    it.qty = qty\n    if (typeof (cart as any).setQty === 'function') {\n      await (cart as any).setQty(it, qty)\n    } else if (typeof (cart as any).update === 'function') {\n      await (cart as any).update(it, { qty })\n    } else {\n      (cart as any).sync?.()\n    }\n    if (typeof (cart as any).reload === 'function') await (cart as any).reload()\n  } catch (e) {\n    console.error(e)\n  } finally { busyId.value = null }\n}\n\nasync function removeItem(it: any) {\n  const id = cartId(it)\n  busyId.value = id\n  try {\n    const idx = itemsRef.value.findIndex(x => cartId(x) === id)\n    if (idx > -1) itemsRef.value.splice(idx, 1)\n\n    if (typeof (cart as any).remove === 'function') {\n      await (cart as any).remove(it)\n    } else if (typeof (cart as any).removeItem === 'function') {\n      await (cart as any).removeItem(it)\n    } else {\n      (cart as any).sync?.()\n    }\n    if (typeof (cart as any).reload === 'function') await (cart as any).reload()\n  } catch (e) {\n    console.error(e)\n    if (typeof (cart as any).reload === 'function') await (cart as any).reload()\n  } finally { busyId.value = null }\n}\n\n/** UI handlers */\nfunction dec(it: any) { setQty(it, Number(it?.qty || 1) - 1) }\nfunction inc(it: any) { setQty(it, Number(it?.qty || 1) + 1) }\nfunction onQtyInput(e: Event, it: any) {\n  const v = (e.target as HTMLInputElement).value.replace(/[^\\d]/g, '')\n  ;(e.target as HTMLInputElement).value = v\n  it.qty = Math.max(1, Number(v) || 1) // local; commit on blur\n}\nfunction onQtyBlur(e: Event, it: any) {\n  const v = Number((e.target as HTMLInputElement).value || 1)\n  setQty(it, v)\n}\nfunction clearAll() {\n  if (confirm(t('cart.clearConfirm') || 'Clear all items from cart?')) {\n    if (typeof (cart as any).clear === 'function') (cart as any).clear()\n    else itemsRef.value.splice(0, itemsRef.value.length)\n    ;(cart as any).sync?.()\n    if (typeof (cart as any).reload === 'function') (cart as any).reload()\n  }\n}\n</script>\n\n<style>\n.btn-primary { @apply inline-flex items-center justify-center rounded-xl bg-orange-500 text-white px-4 py-2 font-medium hover:bg-orange-600 transition; }\n.btn-ghost   { @apply inline-flex items-center justify-center rounded-xl bg-white text-gray-700 border border-gray-200 px-4 py-2 hover:bg-gray-50 transition; }\n.tabular-nums { font-variant-numeric: tabular-nums; }\n</style>\n"],"version":3}