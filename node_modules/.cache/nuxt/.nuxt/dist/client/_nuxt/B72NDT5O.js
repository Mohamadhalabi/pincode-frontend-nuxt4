import{i as N,k as r,q as I,l as S,f as C,c as l,a as t,m as U,z as v,I as X,h as a,J as y,F as _,r as g,A as b,K as h,o,t as f}from"./ClNtL1l2.js";import{u as B}from"./BKRRKjx3.js";const D={class:"max-w-2xl mx-auto space-y-6"},L={class:"card p-5 space-y-4"},M=["value"],q={key:0},A={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},F=["placeholder","onUpdate:modelValue"],K={class:"flex items-center gap-3"},T=["disabled"],$={key:0},z={key:1},j=N({__name:"new",setup(E){const{$get:k,$post:x}=B(),p=r([]),i=r(""),c=I({}),d=r(""),u=r(!1);S(async()=>{const n=await k("/service-categories?active=1");p.value=n.data||n});const m=C(()=>p.value.find(n=>n.id==i.value)),w=async()=>{u.value=!0;try{const n={service_category_id:Number(i.value),input_payload:c,dedupe_key:d.value||null};await x("/vin-lookups",n),await h("/lookups")}finally{u.value=!1}};return(n,e)=>(o(),l("div",D,[e[6]||(e[6]=t("h1",{class:"text-xl font-semibold"},"New VIN Lookup",-1)),t("div",L,[t("div",null,[e[3]||(e[3]=t("label",{class:"label"},"Category",-1)),v(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>y(i)?i.value=s:null),class:"input"},[e[2]||(e[2]=t("option",{disabled:"",value:""},"Select a category…",-1)),(o(!0),l(_,null,g(a(p),s=>(o(),l("option",{key:s.id,value:s.id},f(s.name)+" ("+f(s.cost_tokens)+" tokens) ",9,M))),128))],512),[[X,a(i)]])]),a(m)?(o(),l("div",q,[e[4]||(e[4]=t("label",{class:"label"},"Inputs",-1)),t("div",A,[(o(!0),l(_,null,g(a(m).required_inputs||[],s=>(o(),l("div",{key:s},[v(t("input",{placeholder:s,"onUpdate:modelValue":V=>a(c)[s]=V,class:"input"},null,8,F),[[b,a(c)[s]]])]))),128))])])):U("",!0),t("div",K,[e[5]||(e[5]=t("label",{class:"label"},"Dedupe key (optional)",-1)),v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>y(d)?d.value=s:null),class:"input",placeholder:"e.g., VIN-XXXX"},null,512),[[b,a(d)]])]),t("button",{class:"btn w-full",disabled:!a(i)||a(u),onClick:w},[a(u)?(o(),l("span",z,"Submitting…")):(o(),l("span",$,"Submit Lookup"))],8,T)])]))}});export{j as default};
